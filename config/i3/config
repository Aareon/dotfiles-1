# i3 config file (v4)
# Please see http://i3wm.org/docs/userguide.html for a complete reference!

set $mod Mod4

# Font for window titles. Will also be used by the bar unless a different font
# is used in the bar {} block below.
# Also changes titlebar height accordingly
#font pango: tewi 9
#font pango: terminus 9
#font pango: terminus 11
#font pango: mononoki Nerd Font 16
#font pango: Iosevka Nerd Font Bold 9
font pango: ProfontIIx Nerd Font 9
#font pango: FuraCode Nerd Font Bold 9
#font pango: pxplus ibm vga8 8

# Use Mouse+$mod to drag floating windows to their wanted position
floating_modifier $mod

# start a terminal
bindsym $mod+Return exec --no-startup-id $term
bindsym $mod+t exec --no-startup-id $term

# start a floating terminal

# urxvt
#bindsym $mod+Shift+Return exec $term --title floatingterm --geometry 80x20
#bindsym $mod+Shift+t exec $term --title floatingterm --geometry 80x20

# st
bindsym $mod+Shift+Return exec --no-startup-id $term -t floatingterm -g 80x20
bindsym $mod+Shift+t exec --no-startup-id $term -t floatingterm -g 80x20

for_window [title="floatingterm"] floating enable

# kill focused window
bindsym $mod+Shift+q kill
# Doesnt work
#bindsym $mod+q exec xkill

# open ghost window
bindsym $mod+g exec --no-startup-id i3 open

# The middle button over a titlebar kills the window
bindsym --release button2 kill

# The right button toggles floating
bindsym button3 floating toggle

# The middle button and a modifer over any part of the window kills the window
# Works but the middle click also goes through the window "under"
 bindsym --whole-window $mod+shift+button2 kill

# start dmenu (a program launcher)
#bindsym $mod+d exec dmenu_run SOS LOOK FOR "rofi" down down down
# There also is the (new) i3-dmenu-desktop which only displays applications
# shipping a .desktop file. It is a wrapper around dmenu, so you need that
# installed.
# bindsym $mod+d exec --no-startup-id i3-dmenu-desktop

# change focus
#bindsym $mod+j focus left
#bindsym $mod+k focus down
#bindsym $mod+l focus up
#bindsym $mod+semicolon focus right

# alternatively, you can use the cursor keys:
bindsym $mod+Left focus left
bindsym $mod+Down focus down
bindsym $mod+Up focus up
bindsym $mod+Right focus right

# move focused window
#bindsym $mod+Shift+j move left
#bindsym $mod+Shift+k move down
#bindsym $mod+Shift+l move up
#bindsym $mod+Shift+semicolon move right

# alternatively, you can use the cursor keys:
bindsym $mod+Shift+Left move left
bindsym $mod+Shift+Down move down
bindsym $mod+Shift+Up move up
bindsym $mod+Shift+Right move right

# split in horizontal orientation
bindsym $mod+h split h

# split in vertical orientation
bindsym $mod+v split v

# enter fullscreen mode for the focused container
bindsym $mod+f fullscreen toggle

# change container layout (stacked, tabbed, toggle split)
bindsym $mod+s layout stacking
bindsym $mod+w layout tabbed
bindsym $mod+e layout toggle split

# toggle tiling / floating
bindsym $mod+Shift+space floating toggle

# change focus between tiling / floating windows
bindsym $mod+space focus mode_toggle

# focus the parent container
bindsym $mod+a focus parent

# focus the child container
#bindsym $mod+d focus child

# Terminal
set $term st
#set $term urxvtc
#set $term urxvt

# Workspace variables
set $ws1 "1"
set $ws2 "2"
set $ws3 "3"
set $ws4 "4"
set $ws5 "5"
set $ws6 "6"
set $ws7 "7"
set $ws8 "8"
set $ws9 "9"
set $ws0 "10"

# switch to workspace
bindsym $mod+1 workspace $ws1
bindsym $mod+2 workspace $ws2
bindsym $mod+3 workspace $ws3
bindsym $mod+4 workspace $ws4
bindsym $mod+5 workspace $ws5
bindsym $mod+6 workspace $ws6
bindsym $mod+7 workspace $ws7
bindsym $mod+8 workspace $ws8
bindsym $mod+9 workspace $ws9
bindsym $mod+0 workspace $ws0

# move focused container to workspace
bindsym $mod+Shift+1 move container to workspace $ws1
bindsym $mod+Shift+2 move container to workspace $ws2
bindsym $mod+Shift+3 move container to workspace $ws3
bindsym $mod+Shift+4 move container to workspace $ws4
bindsym $mod+Shift+5 move container to workspace $ws5
bindsym $mod+Shift+6 move container to workspace $ws6
bindsym $mod+Shift+7 move container to workspace $ws7
bindsym $mod+Shift+8 move container to workspace $ws8
bindsym $mod+Shift+9 move container to workspace $ws9
bindsym $mod+Shift+0 move container to workspace $ws0

# Specific Workspace options
#assign [class="Firefox"] $ws1
#assign [class="Chromium-browser"] $ws1
assign [class="discord"] $ws3
assign [class="TelegramDesktop"] $ws3
assign [class="TeamSpeak 3"] $ws3
#assign [class="Sublime_text"] $ws4
#assign [class="Thunar"] $ws5
#assign [class="Evince"] $ws5
assign [class="Gimp"] $ws6
#assign [class="VirtualBox"] $ws7
#assign [class="vlc"] $ws8

# Games
assign [class="Steam"] $ws8
for_window [class="Steam" title=".*Chat.*"] move to workspace $ws3
for_window [class="Steam" title=".*Friends.*"] move to workspace $ws3
for_window [class="Steam" title=".*Chat.*"] floating enable
for_window [class="Steam" title=".*Friends.*"] floating enable

assign [class="battle.net.exe"] $ws8
assign [class="Lutris"] $ws9

# tubify
assign [title="tubify"] $ws0
for_window [title="tubify"] floating enable

# calculator
for_window [class="Galculator"] floating enable


# For gimp (not needed anymore since im using single window mode)
#for_window [window_role="gimp-dock"] floating disable; move left; resize shrink width 50 px or 50ppt
#for_window [window_role="gimp-toolbox"] floating disable; move right; resize grow width 30 px or 30ppt
#for_window [class="Gimp"] floating enable


# reload the configuration file
#bindsym $mod+Shift+c reload
# restart i3 inplace (preserves your layout/session, can be used to upgrade i3)
bindsym $mod+Shift+r restart
# restart Xresources
bindsym $mod+Shift+w exec --no-startup-id xrdb ~/.Xresources

# exit i3 (logs you out of your X session)
#bindsym $mod+Shift+e exec "i3-nagbar -t warning -m 'You pressed the exit shortcut. Do you really want to exit i3? This will end your X session.' -b 'Yes, exit i3' 'i3-msg exit'"
bindsym $mod+Shift+x exec i3-msg exit

# resize window (you can also use the mouse for that)

set $resize_mode "» resize"

mode $resize_mode {
        # These bindings trigger as soon as you enter the resize mode

        # Pressing left will shrink the window’s width.
        # Pressing right will grow the window’s width.
        # Pressing up will shrink the window’s height.
        # Pressing down will grow the window’s height.
        bindsym h resize shrink width 10 px or 10 ppt
        bindsym j resize grow height 10 px or 10 ppt
        bindsym k resize shrink height 10 px or 10 ppt
        bindsym l resize grow width 10 px or 10 ppt

        # same bindings, but for the arrow keys
        bindsym Left resize shrink width 10 px or 10 ppt
        bindsym Down resize grow height 10 px or 10 ppt
        bindsym Up resize shrink height 10 px or 10 ppt
        bindsym Right resize grow width 10 px or 10 ppt

        # back to normal: Enter or Escape
        bindsym Return mode "default"
        bindsym Escape mode "default"
        bindsym r mode "default"
        bindsym $mod+r mode "default"
}

bindsym $mod+r mode $resize_mode

##################################### Customization ####################################

# Default layout
#workspace_layout default|stacking|tabbed
#workspace_layout stacking

# Focus follows mouse
focus_follows_mouse no

# For instance: Assume you are on workspace "1: www" and switch to "2: IM" 
# using mod+2 because somebody sent you a message. You don’t need to 
# remember where you came from now, you can just press $mod+2 again 
# to switch back to "1: www".
workspace_auto_back_and_forth yes

########################## STYLE ##########################

# Borders 
# border normal|pixel (titlebar|notitlebar)
# border none|toggle

# Border width
set $border_width 0

# only titlebar (doesnt work well with gaps enabled (visual glitches) unless you are tabbed or stacked)
# compton helps with the glitching a lot though
#for_window [class="^.*"] border normal 0

# border only
for_window [class="^.*"] border pixel $border_width

# no titlebar no border
#for_window [class="^.*"] border none

# Borders only on terminal
#for_window [class="URxvt"] border pixel $border_width
#for_window [class="st-256color"] border pixel $border_width
#for_window [class="st"] border pixel $border_width

set $wave .:*~*:._.:*~*:.
set $decor X

# titlebar format

# empty
#for_window [class=".*"] title_format <span></span>

# full wave title
#for_window [class=".*"] title_format <span font_desc='tewi 7'>$wave$wave$wave$wave$wave$wave$wave$wave$wave$wave$wave$wave$wave$wave$wave$wave$wave$wave</span>

# simple title
#for_window [class=".*"] title_format <span font_desc='tewi 7'> » %title</span>
#for_window [class=".*"] title_format <span font_desc='terminus 12'> » %title</span>
#for_window [class=".*"] title_format <span font_desc='pxplus ibm vga8 11'> » %title</span>
#for_window [class=".*"] title_format " » %title"
#for_window [class=".*"] title_format "  %title"
for_window [class=".*"] title_format "  %title"
#for_window [class=".*"] title_format <span> </span><span font_desc='Siji 7'></span> %title

# title box
#for_window [class=".*"] title_format <span background='$color8' foreground='$color0' font_desc='mononoki Nerd Font 11'> </span><span background='$color8' font_desc='Siji 7'></span><span background='$color8' foreground='$color7' font_desc='Terminus 7' > %title </span><span foreground='$color8' font_desc='mononoki Nerd Font 11'></span> 

# class box - wave - title box
#for_window [class=".*"] title_format <span background='$color8' foreground='$color0' font_desc='mononoki Nerd Font 11'> </span><span background='$color8' font_desc='Siji 7'></span><span background='$color8' foreground='$color7' font_desc='Terminus 7' > %class </span><span foreground='$color8' font_desc='mononoki Nerd Font 11'></span><span font_desc='Terminus 7'>  $wave</span><span background='$color8' foreground='$color0' font_desc='mononoki Nerd Font 11'> </span><span background='$color8' font_desc='Siji 7'></span><span background='$color8' foreground='$color7' font_desc='Terminus 7' > %title </span><span foreground='$color8' font_desc='mononoki Nerd Font 11'></span> 

# Border width 
#new_window pixel 2
#new_window normal 0

# Firefox appearance
#for_window [class="Firefox"] border none

# Global gaps
set $inner_default 5
set $outer_default 0

gaps inner $inner_default
gaps outer $outer_default

# Enable gaps only if there is more than one container
# smart_gaps on

# Hide borders when only 1 window is open in the workspace
#hide_edge_borders both
#hide_edge_borders smart

# Wallpaper
exec_always --no-startup-id ~/.fehbg  

##################################### Colors ####################################

# Grab colors from Xresources (requires reloading xrdb and i3)
set_from_resource $color0 i3wm.color0 #050505
set_from_resource $color1 i3wm.color1 #AA0000
set_from_resource $color2 i3wm.color2 #00AA00
set_from_resource $color3 i3wm.color3 #FFFF55
set_from_resource $color4 i3wm.color4 #0000AA
set_from_resource $color5 i3wm.color5 #AA00AA
set_from_resource $color6 i3wm.color6 #00AAAA
set_from_resource $color7 i3wm.color7 #AAAAAA
set_from_resource $color8 i3wm.color8 #666666
set_from_resource $color9 i3wm.color1 #AA0000
set_from_resource $color10 i3wm.color10 #00AA00
set_from_resource $color11 i3wm.color11 #FFFF55
set_from_resource $color12 i3wm.color12 #0000AA
set_from_resource $color13 i3wm.color13 #AA00AA
set_from_resource $color14 i3wm.color14 #00AAAA
set_from_resource $color15 i3wm.color15 #AAAAAA

# Urgent color
set_from_resource $colorU i3wm.color9 #AAAAAA
# Focused color
set_from_resource $colorF i3wm.color12 #AAAAAA
# Inactive color
set_from_resource $colorI i3wm.color11 #AAAAAA
# uNfocused color
set_from_resource $colorN i3wm.color8 #666666
# Background color
set_from_resource $colorB i3wm.color0 #666666
#set $colorB #000000

# Example
#set $color7 #AAAAAA

####### NORMAL #######
# class                 border	background	text	indicator	child_border
client.focused		$colorB	$colorB		$colorF	$colorF		$colorF
client.focused_inactive	$colorB	$colorB		$colorI	$colorI		$colorI
client.unfocused	$colorB	$colorB		$colorN	$colorN		$colorN		
client.urgent		$colorB	$colorB		$colorU	$colorU		$colorU		
client.placeholder	$color7	$color0		$color7	$color7		$color7		


####### DARK #######
# class                 border	background	text	indicator	child_border
#client.focused		$colorB	$colorB		$colorF	$colorB		$colorF
#client.focused_inactive	$colorB	$colorB		$colorI	$colorB		$colorB
#client.unfocused	$colorB	$colorB		$colorN	$colorB		$colorB		
#client.urgent		$colorB	$colorB		$colorU	$colorB		$colorB		
#client.placeholder	$colorB	$colorB		$color7	$colorB		$colorB		


####### FOR POWERLINE / TRIANGLES / SYMBOLS ####### todo
#client.focused		$color0	$color0		$colorF	$color0		$colorF
#client.focused_inactive	$color0	$color0		$colorI	$color0		$color0
#client.unfocused	$color0	$color0		$colorI	$color0		$color0		
#client.urgent		$color0	$color0		$color7	$color0		$color0		
#client.placeholder	$color0	$color0		$color7	$color0		$color0		

client.background       #ffffff


##################################### Keybinds ####################################

# Gaps mode
set $gaps_mode "» gaps"
bindsym $mod+shift+g mode $gaps_mode
mode $gaps_mode {
	
	# arrow keys
	bindsym Up gaps inner current plus 5
	bindsym Down gaps inner current minus 5

	bindsym Right gaps outer current plus 5
	bindsym Left gaps outer current minus 5
	
	# plus / minus
	bindsym plus  gaps inner current plus 5
	bindsym minus gaps inner current minus 5
	bindsym 0     gaps inner current set 0

	bindsym shift+plus  gaps outer current plus 5
	bindsym shift+minus gaps outer current minus 5
	bindsym shift+0     gaps outer current set 0

	# Restore defaults
	bindsym d gaps inner all set $inner_default
	bindsym shift+d gaps outer all set $outer_default

	# Exit gaps mode
	bindsym g mode "default"
	bindsym $mod+g mode "default"
	bindsym $mod+shift+g mode "default"
	bindsym Return mode "default"
	bindsym Escape mode "default"
}


# System monitor
bindsym $mod+Shift+h exec --no-startup-id $term -e htop


# Quick Launcher
set $launcher_mode "» launcher"
bindsym $mod+z mode $launcher_mode
mode $launcher_mode {
	
	bindsym q exec "notify-send 'Launching qutebrowser' --urgency low; qutebrowser"
	bindsym w exec "notify-send 'Launching Firefox' --urgency low; firefox"
	bindsym e exec "notify-send 'Launching Sublime Text' --urgency low; subl"
	bindsym f exec "notify-send 'Launching Thunar' --urgency low; thunar"
	bindsym l exec "notify-send 'Launching Lutris' --urgency low; lutris"
	bindsym g exec "notify-send 'Launching GIMP' --urgency low; gimp"
	bindsym s exec "notify-send 'Launching Steam' --urgency low; steam"
	bindsym d exec "notify-send 'Launching Discord' --urgency low; discord"
	bindsym v exec "notify-send 'Launching VMware' --urgency low; vmware"
	bindsym c exec --no-startup-id ~/Scripts/compositor
	bindsym x exec --no-startup-id flux
	
	bindsym z mode "default"
	bindsym $mod+z mode "default"
	bindsym Return mode "default"
	bindsym Escape mode "default"
}

# Music
bindsym $mod+y exec --no-startup-id ~/Scripts/Rofi/rofi_tubify
bindsym $mod+shift+y exec --no-startup-id ~/Scripts/mpv-query.sh
bindsym $mod+Shift+m exec --no-startup-id $term -e ncmpcpp

set $music_mode "» music"

mode $music_mode {
	
	bindsym Left exec --no-startup-id mpc prev
	bindsym Right exec --no-startup-id mpc next
	
    # mpc
	bindsym p exec --no-startup-id mpc toggle
	bindsym n exec --no-startup-id mpc next
	bindsym b exec --no-startup-id mpc prev

    # tubify (mpv)
	bindsym $mod+p exec --no-startup-id xdotool key --window "$(xdotool search --name tubify)" p
    bindsym $mod+n exec --no-startup-id xdotool key --window "$(xdotool search --name tubify)" greater
    bindsym $mod+b exec --no-startup-id xdotool key --window "$(xdotool search --name tubify)" less
	bindsym $mod+i exec --no-startup-id ~/Scripts/mpv-query.sh
	bindsym i exec --no-startup-id ~/Scripts/mpv-query.sh
	
	bindsym m mode "default"
	bindsym $mod+m mode "default"
	bindsym Return mode "default"
	bindsym Escape mode "default"
}
bindsym $mod+m mode $music_mode

# File Manager
bindsym $mod+Shift+f exec thunar

# System Monitors (notification)
bindsym $mod+n exec --no-startup-id ~/Scripts/monitor_notification.sh

# Multimedia keys
#increase sound volume
#bindsym XF86AudioRaiseVolume exec --no-startup-id pactl set-sink-volume 0 +5%
bindsym XF86AudioRaiseVolume exec --no-startup-id pactl set-sink-mute 0 0 && pactl set-sink-volume @DEFAULT_SINK@ +5%
#decrease sound volume
#bindsym XF86AudioLowerVolume exec --no-startup-id pactl set-sink-volume 0 -5%
bindsym XF86AudioLowerVolume exec --no-startup-id pactl set-sink-mute 0 0 && pactl set-sink-volume @DEFAULT_SINK@ -5%
# mute sound
bindsym XF86AudioMute exec --no-startup-id pactl set-sink-mute 0 toggle 

# Rofi (Instead of dmenu) (Edit config for colors etc!)
#bindsym $mod+d exec rofi -show run
bindsym $mod+d exec ~/Scripts/Rofi/rofi_launch
bindsym $mod+Tab exec ~/Scripts/Rofi/rofi_combi
bindsym $mod+Shift+d exec --no-startup-id "rofi -show drun -run-command 'gksudo {cmd}'"

#  ============= screenshots ============= 
# take full screenshot
bindsym Print exec --no-startup-id ~/Scripts/screenshot.sh
bindsym $mod+c exec --no-startup-id ~/Scripts/screenshot.sh

# select area to capture
bindsym $mod+Shift+Print --release exec --no-startup-id ~/Scripts/screenshot.sh -s
bindsym $mod+Shift+c --release exec --no-startup-id ~/Scripts/screenshot.sh -s

# save selection to clipboard
bindsym $mod+Control+Print exec --no-startup-id ~/Scripts/screenshot.sh -c
bindsym $mod+Control+c exec --no-startup-id ~/Scripts/screenshot.sh -c

# open most recent screenshot with gimp
bindsym $mod+Print exec --no-startup-id "cd ~/Pictures/Screenshots ; gimp $(ls -t | head -n1) &"

##################################### autostart ####################################
# if the persistent workspaces patch is applied, cycle through all workspaces
# in order to "create" them once
exec --no-startup-id ~/Scripts/cycle_workspaces.sh

# urxvt daemon
#exec --no-startup-id urxvtd -q -o -f

# For battery notifications
exec --no-startup-id xfce4-power-manager &

# Compton
exec --no-startup-id ~/Scripts/compositor

# Enable numlock
exec --no-startup-id numlockx &

# Keyboard lang
exec --no-startup-id setxkbmap -layout "us,gr,ru" -option "grp:alt_shift_toggle" &

# Mpd
exec --no-startup-id mpd ~/.config/mpd/mpd.conf &

# Bar
exec_always --no-startup-id barstart &

# Run htop on $ws0 on startup
#exec --no-startup-id i3-msg 'workspace $ws0; exec $term -e htop'

# Lock the screen after booting
# exec ~/mylock

# Scratchpad
#exec_always --no-startup-id $term -title=dropdown -e tmux
#for_window [title="dropdown"] floating enable;
#for_window [title="dropdown"] move scratchpad; [instance="dropdown"] scratchpad show; move scratchpad
#bindsym $mod+u [title="dropdown"] scratchpad show

# Fix a bug in gnome-settings-daemon: http://feeding.cloud.geek.nz/posts/creating-a-modern-tiling-desktop-environment-using-i3/
#exec --no-startup-id dconf write /org/gnome/settings-daemon/plugins/cursor/active false

# Needed to configure things
#exec --no-startup-id cinnamon-settings-daemon &>/home/leni/cinnamon-debug
#exec --no-startup-id nm-applet
